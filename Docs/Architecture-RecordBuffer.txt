# Hippocrates 360 – Record Buffer Architecture (PRecord & setProp)

Този документ описва механизма за промяна, валидиране и запис на данни в Хипократ 360.  
Той е централната част от архитектурата на ADB/LNK модела и определя как UI, колекциите и базата данни работят синхронно без загуба на производителност.

---

# 1. Overview

При зареждане на ADB/LNK файловете:

- **всички колекции са празни**
- **няма създадени TPregledItem / TPatientItem обекти**
- **единственото, което реално съществува, са LNK възлите**

Т.е. при стартиране:

✔ няма реални Delphi обекти  
✔ няма алокации  
✔ UI чете директно от ADB по `DataPos`  
✔ системата се държи като “infinite lazy-load”

Обектите се създават **само ако потребителят промени нещо**.

---

# 2. Какво представлява PRecord

За всеки запис в система (Пациент, Преглед, Диагноза…) генераторът създава структура:

```pascal
PRecPregledNew = ^TRecPregledNew;
TRecPregledNew = record
  AMB_LISTN: Integer;
  ANAMN: AnsiString;
  ...
  setProp: TSetProp;   // bitmap на променените полета
end;
